# Template JSON Schema (Compact Keys)

This document describes the **compact JSON format** generated by the Poster Studio app.
Short keys keep file size small; this file explains what each key means for your dev team.

---

## 1. Top-level object

Example:

```json
{
  "ar": "1080:1350",
  "t": true,
  "pc": ["Health", "Motivation"],
  "lg": ["English"],
  "bg": "data:image/jpeg;base64,...",
  "mt": "image",
  "ip": { ... },
  "np": { ... }
}
```

### 1.1 Keys

| Key | Type              | Meaning                                                                 |
|-----|-------------------|-------------------------------------------------------------------------|
| `ar` | string            | **aspectRatio** – e.g. `"1080:1350"`                                   |
| `t`  | boolean           | **isProfileTemplate** – `true` = Self (Profile), `false` = Wishes      |
| `pc` | string[]          | **primaryCategories** – Self/Wishes tags from the approved list        |
| `lg` | string[]          | **languageTags** – e.g. `["English","Hindi"]`                          |
| `bg` | string \| null    | **backgroundImage** – data URL (image/video) or `null`                 |
| `mt` | `"image" \| "video"` | **mediaType** – how to interpret `bg`                               |
| `ip` | object            | **imagePlaceholder** – circular/square photo position & styling        |
| `np` | object            | **namePlaceholder** – name text band position & styling                |

---

## 2. `ip` – Image Placeholder

```json
"ip": {
  "x": 50,
  "y": 20,
  "d": 28,
  "sh": "circle",
  "cr": 16,
  "hb": true,
  "sw": 4,
  "sc": "#FFFFFF"
}
```

### 2.1 Keys

| Key | Type              | Meaning                                                                 |
|-----|-------------------|-------------------------------------------------------------------------|
| `x`  | number            | **x position** – % of canvas width (0–100)                             |
| `y`  | number            | **y position** – % of canvas height (0–100)                            |
| `d`  | number            | **diameter** – % of canvas width (0–100)                               |
| `sh` | `"circle" \| "square"` | **shape** – circle avatar or rounded square                       |
| `cr` | number (optional) | **cornerRadius** – only when `sh === "square"` (design px)             |
| `hb` | boolean           | **hasBackground** – `true` keep original BG, `false` treat as cutout   |
| `sw` | number            | **strokeWidth** – border around photo (design px)                      |
| `sc` | string            | **strokeColor** – hex color (`"#FFFFFF"`)                              |

Usage notes for rendering:
- Compute canvas pixel size, then:
  - `photoWidth = (d / 100) * canvasWidth`
  - `photoHeight = photoWidth`
  - `photoX = (x / 100) * canvasWidth`
  - `photoY = (y / 100) * canvasHeight`

---

## 3. `np` – Name Placeholder

```json
"np": {
  "y": 55,
  "h": 10,
  "st": {
    "ts": {
      "c": "#FFFFFF",
      "fs": 64,
      "fw": 500,
      "ls": 0,
      "shRn": {
        "textShadowOffset": { "width": 0, "height": 2 },
        "textShadowRadius": 8,
        "textShadowColor": "rgba(0,0,0,0.65)"
      },
      "stRn": [],
      "ta": "center"
    }
  }
}
```

### 3.1 Position & size

| Key | Type   | Meaning                                                          |
|-----|--------|------------------------------------------------------------------|
| `y` | number | **y position** – % of canvas height for the top of the band     |
| `h` | number | **height** – % of canvas height for the name band               |

**Important design contract:**
- X position and width are **not in JSON**:
  - X is always **centered** in your app.
  - Width is a fixed % (e.g. 80%) of canvas width, defined in your frontend.
- Only **Y** and **height** vary per template.

Rendering suggestion:
- `bandHeight = (h / 100) * canvasHeight`
- `bandY = (y / 100) * canvasHeight`
- `bandWidth = 0.8 * canvasWidth` (or value you choose)
- `bandX = (canvasWidth - bandWidth) / 2`

---

## 4. `np.st.ts` – Text Styling

`np.st.ts` (textStyle) is a compact form of your full text styling config.

### 4.1 Keys

| Key    | Type    | Meaning                                         |
|--------|---------|-------------------------------------------------|
| `c`    | string  | **color** – hex (`"#FFFFFF"`)                   |
| `fs`   | number  | **fontSize** – design px                        |
| `fw`   | number  | **fontWeight** – numeric (e.g. 300, 400, 500)   |
| `ls`   | number  | **letterSpacing** – design px                   |
| `shRn` | object  | **React Native** shadow object (see below)      |
| `stRn` | array   | **React Native** stroke/shadow array (see below)|
| `ta`   | `"left" \| "center" \| "right"` | **textAlignment**       |

### 4.2 `shRn` – React Native Text Shadow

```json
"shRn": {
  "textShadowOffset": { "width": 0, "height": 2 },
  "textShadowRadius": 8,
  "textShadowColor": "rgba(0,0,0,0.65)"
}
```

| Key  | Meaning          |
|------|------------------|
| `textShadowOffset` | `{ width: number, height: number }` – offset in px |
| `textShadowRadius` | number – blur radius in px |
| `textShadowColor` | string – rgba color string |

### 4.3 `stRn` – React Native Text Stroke

React Native doesn't support `textStroke` natively. The `stRn` array simulates stroke using multiple text shadows:

```json
"stRn": [
  { "textShadowOffset": { "width": 2, "height": 0 }, "textShadowRadius": 0, "textShadowColor": "#000000" },
  { "textShadowOffset": { "width": -2, "height": 0 }, "textShadowRadius": 0, "textShadowColor": "#000000" },
  // ... 24 shadow objects forming a circle around the text
]
```

| Key  | Meaning          |
|------|------------------|
| Array items | Each object is a shadow that forms part of the stroke outline |
| `textShadowOffset` | Position offset for this shadow |
| `textShadowRadius` | Always `0` for stroke simulation |
| `textShadowColor` | Stroke color (hex string) |

---

## 5. TypeScript Type

The app exports this type for tooling:

```ts
import type { CompactTemplateJSON } from '@/templateSchema';
```

`CompactTemplateJSON` is the exact type used for export.  
See `src/templateSchema.ts` for the full definition and a key → meaning map (`TEMPLATE_KEY_MAP`).

---

## 6. Summary for Implementers

- **Only parse the compact keys** listed here (`ar`, `t`, `pc`, `lg`, `bg`, `mt`, `ip`, `np`, etc.).
- Reconstruct your internal model using the mapping in `src/templateSchema.ts`.
- Treat:
  - `ip` as the **photo layer** (circle/square)
  - `np` as the **name text band**
- X-centering and width % for the name band live in **your frontend**, not in JSON.

